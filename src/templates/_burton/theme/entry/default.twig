{## Theme Default Entry âžœ _burton/theme/entry/default.twig -------------------}
{##--------------------------------------------------------------------------#}
{%- extends "_burton/base/entry/default" -%}

{%- block body__id    "entry-#{entry.id ?? null}" -%}
{%- block body__class "#{parent()} entry entry--#{entry.type.handle ?? null}" -%}

{## <time> Tag
{-------------------------------------------------------------------------------------##}
{%- macro datetime( date = null ) -%}
    {{- date ? tag( 'time', {
        html    : date|date(varargs.format|default('F j, Y')),
        datetime: date|date('Y-m-d'),
        itemprop: varargs.itemprop|default('datePublished'),
    }) -}}
{%- endmacro -%}


{## Article Read Time Calculation
{-------------------------------------------------------------------------------------##}
{%- macro readtime( content ) -%}
    <span>5 min</span>
{%- endmacro -%}


{## Social Media Sharing Icons
{-------------------------------------------------------------------------------------##}
{%- macro sharing( url ) -%}
    {%- set encode = url|url_encode -%}
    {%- set title  = varargs.title|default('') -%}
    {%- set class  = varargs.class|default('fill-current h-6 w-6') -%}

    <div class="flex gap-3">
        {{- tag( 'a', {
            href: "https://www.linkedin.com/shareArticle?url=#{encode}",
            target: '_blank',
            aira_label: 'Share on LinkedIn',
            html: svg('@webroot/static/svg/linkedin.svg') | attr({ class: class }),
        }) -}}

        {{- tag( 'a', {
            href: "https://twitter.com/intent/tweet?url=#{encode}&text=#{title|url_encode}",
            target: '_blank',
            aira_label: 'Share on Twitter/X',
            html: svg('@webroot/static/svg/twitter.svg') | attr({ class: class }),
        }) -}}

        {{- tag( 'a', {
            href: "mailto:?body=#{url}&subject=#{title|url_encode}",
            target: '_blank',
            aira_label: 'Share via Email',
            html: svg('@appicons/envelope.svg') | attr({ class: class }),
        }) -}}

        {{- tag( 'a', {
            aira_label: 'Copy Link',
            javascript: "copyToClipboard('#{url}')",
            html: svg('@appicons/link.svg') | attr({ class: class }),
        }) -}}
    </div>

    {%- js -%}
        {% import '_theme/javascript' as javascript %}
        {{- javascript.copyToClipboard() -}}
    {%- endjs -%}
{%- endmacro -%}


{%- macro comments( entryId ) -%}
    {%- set comments = collect(
        craft.formie.submissions().parentEntry(entryId)
        .form('comment').status(["approved"]) ) -%}

    {%- if comments|length -%}
        <div class="space-y-4 max-w-4xl">
            {%- for submission in comments.all() -%}
                <div class="flex gap-4 p-4 border rounded-xl shadow-sm bg-theme-tint">
                    <div class="flex flex-col items-center w-28 gap-2">
                        <div class="w-24 h-24 rounded-full bg-white flex items-center justify-center text-gray-400">
                            {{ svg('@appicons/user.svg') | attr({ class: ["w-12 h-12 fill-theme-highlight"] }) }}
                        </div>
                        <div class="font-medium text-center">
                            {{ submission.name1.firstName | title }} {{ submission.name1.lastName | first | upper }}.
                        </div>
                    </div>

                    <div class="flex-1 @container pt-2">
                        <p class="smaller">{{ submission.comment ??? submission.message ??? '' }}</p>
                        <div class="flex justify-between">
                            <div class="flex gap-1">
                                {%- set rating = submission.rating.value ?? 0 | integer -%}
                                {%- if rating >= 1 -%}
                                    {%- for i in 1..5 -%}
                                        {{- svg('@appicons/star.svg') | attr({
                                            class: [ "w-6 h-6", i <= rating ? "fill-gold" : "stroke-gold"] })
                                        -}}
                                    {%- endfor -%}
                                {%- endif -%}
                            </div>
                            <div>{{ submission.dateCreated|date('F j, Y') }}</div>
                        </div>
                    </div>
                </div>
            {%- endfor -%}
        </div>
    {%- else -%}
        <div class="h4">No comments yet</div>
    {%- endif -%}
{%- endmacro -%}