{%- extends "_burton/javascript" -%}

{%- macro parallax( script = true ) -%}
    {{ script ? '<script>' }}
    window.waitForGlobal("app.gsap", function() {
        app.gsap.utils.toArray("*[data-parallax='true']").forEach((parallax, i) => {
            const speed = parseFloat(parallax.dataset.speed) || 0.3;

            app.gsap.fromTo(parallax.querySelector("svg"), {
                y: -100,
                opacity: 0,
                scale: 0.7,
            }, {
                y: 300 * speed,
                opacity: 0.35,
                scale: 0.9,
                ease: "none",
                scrollTrigger: {
                    trigger: parallax,
                    start: "top bottom",
                    end: "bottom top",
                    scrub: true,
                    invalidateOnRefresh: true
                }
            });
        });
    });
    {{ script ? '</script>' }}
{%- endmacro -%}